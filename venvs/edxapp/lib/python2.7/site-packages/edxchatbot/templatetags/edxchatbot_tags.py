from django import template
from edxchatbot.models import CourseChatbot

register = template.Library()

@register.filter
def get_chatbot_url(course_id):
    """
    Get chatbot url for the course

    """
    if "/courses/" in course_id and ("/course/" in course_id or "/discussion/" in course_id):
        cid = course_id.split("/courses/")[1].split("/")[0]
        try:
            course_chatbot = CourseChatbot.objects.get(course_id=cid)
            return course_chatbot.chatbot_url
        except CourseChatbot.DoesNotExist:
            return ""   
    else:
        return ""
